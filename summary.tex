\documentclass[10pt]{article}
\usepackage{amsmath}
\begin{document}

\section{System}
\begin{align}
u_t &= u_{xx} + (1-v)F(w) \\
v_t &= \epsilon v_{xx} + (1-v)F(w)\\
w &= hu+(1-h)v
\end{align}
with $h \in [0,1], \epsilon \in (0,1]$.

We take a discontinuous nonlinearity
\begin{equation}
F(w) = \left\{\begin{array}{ll}
\mathrm{exp}\left(Z\left\{\frac{w-h}{\sigma+(1-\sigma)w} \right\} \right) & w \geq w^*\\
0 & w < w^*
\end{array} \right.
\end{equation}


\section{Waves}
\begin{align}
&U_{xx} + cU_x + (1-V)F(W) = 0\\
&\epsilon V_{xx} + cV_x + (1-V)F(W) = 0\\
&W = hU+(1-h)V
\end{align}

At $-\infty$, $(U,V) \to (1,1)$, and at $\infty$, $(U,V) \to (0,0)$.

In the region $w < w^*$ where the nonlinearity is zero, these equations do not involve $U$ and $V$ at all---they are differential equations for $U_x$ and $V_x$.
As a result, integration may not hit $(0,0)$. To fix this, we integrate the system.

Let
\begin{equation}
z = \frac{1}{c}\int_\xi^\infty (1-V)F(W)
\end{equation}
Clearly $z=0$ at $\infty$.  After integration we will get $z=1$ at $-\infty$.

This gives
\begin{equation}
z_\xi = -\frac{1}{c}(1-V)F(W)
\end{equation}
so
\begin{align}
&z'= -\frac{1}{c}(1-V)F(W)\\
&U_{\xi\xi}+cU_\xi-cz_\xi = 0\\
&\epsilon V_{\xi\xi}+cV_\xi-cz_\xi = 0
\end{align}
The latter two may now be integrated.

\begin{align}
&U_\xi + cU - cz = q \\
&\epsilon V_\xi + cV - cz = q
\end{align}
At $\infty$, each of $U_\xi$, $U$, and $z$ go to 0, so $q=0$.
At $-\infty$, we get $z=1$.
\begin{align}
&U_\xi + cU - cz = 0 \\
&\epsilon V_\xi + cV - cz = 0
\end{align}

Thus, our end behavior is $(U,V,z) \to (1,1,1)$ at $-\infty$, and $(U,V,z) \to (0,0,0)$ at $\infty$.

\subsection{$\epsilon = 0$}
In this case, we get $V = z$, and the system is two-dimensional.


\section{Finding $c$}
We find $c$ by integrating the ODE, from a point $\epsilon$-close to $(1,1,1)$.
At different values of $c$, we end up at different points, and there's only one correct value where we hit $(0,0,0)$.
We can tell whether our value is too high or low by where the terminus is: if $c$ is too low, we finish with $U,V < 0$, and vice versa.  This lets us perform a simple binary search to approach the correct value of $c$.


\section{Linearization}
First, moving frame version:
\begin{align}
u_t &= u_{xx} + c u_x + (1-v)F(w) \\
v_t &= \epsilon v_{xx} + c v_x+ (1-v)F(w)\\
\end{align}
This linearizes to
\begin{align}
u_t &= u_{xx} + c u_x + K_u u \\
v_t &= \epsilon v_{xx} + c v_x+ K_v v
\end{align}
where $K = (1-v)F(w)$.
$K_u$ and $K_v$ are evaluated at the front.

For $w \geq w^*$, $K_u$ and $K_v$ are each messy functions of $u$ and $v$; we find them with computer algebra.
For $w < w^*$, since $F = 0$ uniformly we have $K_u = K_v = 0$.

This gives us the operator
\[
L = \begin{bmatrix}
\delta_{xx} + c \delta_x + K_u  &  K_v  \\
K_u  &  \epsilon \delta_{xx} + c \delta_x + K_v
\end{bmatrix}
\]
We wish to solve $LX = \lambda X$, i.e.
\begin{align}
\lambda u_t &= u_{xx} + c u_x + K_u u \\
\lambda v_t &= \epsilon v_{xx} + c v_x+ K_v v
\end{align}

We rewrite this as a first-order system $X' = AX$ by introducing $u_x = s$.  Fixing $\epsilon=0$ for now, we get
\begin{align}
u_x &= s \\
s_x &= \lambda u - c s - K_u u - K_v v \\
v_x &= (\lambda v - K_u u - K_v v)/c
\end{align}
Writing as a matrix, with $X$ dependency from $K_u$ and $K_v$,
\[
X = \begin{bmatrix}u\\s\\v\end{bmatrix},
A = \begin{bmatrix}
0 & 1 & 0 \\
\lambda - K_u  &  -c  &  -K_v \\
- K_u/c  &  0  &  (\lambda - K_v)/c
\end{bmatrix}
\]

\section{Eigenvalues}
\subsection{$+\infty$}
At $X = 0$, we have $K_u = K_v = 0$, so this simplifies to
\[
A = \begin{bmatrix}
0 & 1 & 0 \\
\lambda &  -c  &  0 \\
0 &  0  &  \lambda/c
\end{bmatrix}
\]
This has eigenvalues $(-c \pm \sqrt{c^2 + 4 \lambda})/2$ and $\lambda/c$.  For $\Re \lambda > 0$, the one with negative real part is
\[\lambda_1 = \frac{-c - \sqrt{c^2 + 4 \lambda}}{2}\]
One eigenvector for it is
\[v_1 = [1,(-c - \sqrt{c^2 + 4 \lambda})/2,0] \]

\subsection{$-\infty$}
At $X = [1,0,1]$ we get
\[
A = \begin{bmatrix}
0 & 1 & 0 \\
\lambda &  -c  &  e^{(1-h)Z} \\
0 &  0  &  (\lambda + e^{(1-h)Z})/c
\end{bmatrix}
\]
with eigenvalues $(-c \pm \sqrt{c^2 + 4 \lambda})/2$ and $(\lambda + e^{(1-h)Z})/c$.

We're actually interested in the adjoint $-A^T$, whose eigenvalues are the negation of those.
Thus, the unique positive eigenvalue is
\[\lambda_2 = \frac{c + \sqrt{c^2 + 4 \lambda}}{2} = -\lambda_1 \]
One eigenvector (of $-A^T$) for that is
\[
v_2 = \left[1, -\frac{c + \sqrt{c^2 + 4 \lambda}}{2\lambda}, \frac{(c + \sqrt{c^2+4\lambda})}{\lambda e^{Z(h-1)}(c + \sqrt{c^2+4\lambda} + 2 \lambda/c)+ 2 \lambda / c}\right]
\]


\section{Evans function}
We pick an appropriate time $d$, and perform two integrations.

We integrate $X' = AX$ from $d$ to $0$, with initial condition $e^{\lambda_1 d}v_1$.

We integrate $X' = -A^T X$ from $-d$ to $0$, with initial condition $e^{\lambda_1 d}v_2' = e^{-\lambda_2 d}v_2'$. The vector $v_2'$ is another eigenvector collinear with $v_2$, but normalized so that $v_1 \cdot v_2' = 1$.
\[v_2' = \frac{v_2}{v_2 \cdot v_1}\]

The Evans function is the dot product of these results at $0$.

\end{document}
